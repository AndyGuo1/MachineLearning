# 线性代数复习-矩阵和矩阵乘法
## 视频
<video height=510 width=900 controls="controls" preload="none">
      <source src="amWiki/videos/001/01-Week1/5-Linear Algebra Review/4-Matrix Matrix Multiplication.mp4" type="video/mp4">
</video>
## 中文
### 矩阵和矩阵乘法
![矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/18-举例说明矩阵和矩阵乘法.jpg)
在这段视频中我们将会讨论 矩阵 矩阵的乘法以及 如何将两个矩阵相乘 我们会使用这样一种方法 在线性回归中用以解决 参数计算的问题 这种方法会把θ0、θ1等参数都放在一起来计算 也就是说 我们不需要一个迭代的梯度下降算法 当我们谈到这个算法的时候 就会发现矩阵以及矩阵间的乘法运算 是你必须理解的关键步骤之一 所以让我们像往常那样 从一个例子开始 比方说 我有两个矩阵 我想将它们相乘 让我先只是按照这个例子做一遍（乘法）然后告诉你这其中运算的细节 那么 我要做的第一件事是 我先把右边这个矩阵的第一列 提取出来 然后我将会把 左边的这个矩阵和 之前取出来的这一列（前面提过的，向量）相乘 这只是第一列 是吧？ 然后我们可以看到 如果我 这么做 我就会得到向量（11,9） 所以这是与上个视频的矩阵 和向量的乘法是一样的我已经提前算出了这个结果 是（11,9） 那么 之后的第二件事 我要做的就是 我将把第二列再单独提出出来 右边这个矩阵的第二列 然后我将要把它和 左边这个矩阵相乘 是的吧 所以 这就是那个矩阵 用右边的第二列 来乘以这个矩阵 因此 同样的 这是一个矩阵和 向量的乘法运算 这 就是你从上一个视频所学到的 如果你这么做 把这个矩阵和这个向量相乘 你会得到 （10,14）这个结果 顺便说一下 如果你想练习 矩阵和向量的乘法运算 那么就先暂停下视频 自己算一算结果对不对 好吧 现在我仅仅需要 将得到的这两个结果放在一起 那么这就是我的答案了 那么 我们可以看到 计算结果是 一个2 x 2的矩阵 我用来填充这个矩阵的方法 就是 把我的（11,9） 填在这里 把（10，14）填在 第二列 是的吧？ 所以 这就是如何将两个矩阵相乘的 详细方法与过程 每次你只需要看 第二个矩阵的一列 然后把你的答案拼凑起来 再次强调下 我们将一步步的来计算 几秒中的时间里需要非常仔细 但我也要指出 我也要指出的是 第一个例子是一个2X3矩阵 乘以一个3x2的矩阵 他们相乘 得到的结果 是一个2x2的 矩阵 我们将很快知道为什么是这个结果好的 这是计算的技巧
### 矩阵和矩阵乘法执行详细过程
![矩阵和矩阵乘法执行详细过程](amWiki/images/001/01-Week1/5-Linear Algebra Review/19-矩阵和矩阵乘法执行详细过程.jpg)
让我们再看看 这其中的细节 看看究竟发生了什么 下面就是详细的过程 我有一个矩阵A 我要把它乘以 矩阵B 其结果 会是一个新的矩阵C 并且你会发现你只能 相乘那些维度 匹配的矩阵 因此如果A是一个m×n的矩阵 就是说m行n列 我将要用它与 一个n×o的矩阵相乘 并且实际上这里的n 必须匹配这里的这个n 所以第一个矩阵的列的数目 必须等于第二矩阵中的行的数目 并且相乘得到的结果 结果会是一个m×o的矩阵 就像这个矩阵C这样 并且 在前面的视频中 我们所做的一切都符合这个规则 这是一种当矩阵B的o值 等于1的特殊情况（指的是矩阵和向量相乘） 明白了吗？ 这是在B是一个向量的情况下 但是现在 我们要处理 O的值大于1的情况 所以 这里就是你怎样 把两个矩阵相乘 为了得到结果 我要做的就是 我将要取 B矩阵的第一列 把取出的这列看成一个向量 并乘以矩阵A 用B矩阵的第一列 这个计算结果将是 m×1的矩阵（也就是一个向量） 我们把结果先放在这里 然后 我将要取 B矩阵的 第二列 那么我会又得到一个n×1的向量 也就是 这里的这一列 这是正确的 n×1的矩阵 也就是n维的向量 我将要把这个矩阵 和这些n乘1的向量相乘 其结果将是 一个m维的向量 然后我会把结果先放在那里 依此类推 对吧？那么 你知道的 我开始取第三列 把它和这个矩阵相乘 我又得到了一个M维向量 依此类推 直到你计算到了 最后一列矩阵乘以 你取到的最后一列 就是C的最后一列 再说一遍 矩阵C的第i列 是根据把 矩阵A与 矩阵B的第i列 相乘得到的 结果 依次相加 从1,2到o依次相加的 对吧？ 那么 我们在这里做一个总结 我们总结了我们为了 计算矩阵C所做的步骤
### 举例说明矩阵和矩阵乘法
![举例说明矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/20-举例说明矩阵和矩阵乘法.jpg)
让我们再看一个例子 比方说我想把这两个矩阵相乘
【此处缺失部分翻译】
### 矩阵和矩阵乘法可以用于机器学习中的多个预测函数
![矩阵和矩阵乘法可以用于机器学习中的多个预测函数](amWiki/images/001/01-Week1/5-Linear Algebra Review/21-矩阵和矩阵乘法可以用于机器学习中的多个预测函数.jpg)
【此处缺失部分翻译】
### 内嵌习题_矩阵和矩阵乘法
![内嵌习题_矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/22-内嵌习题_矩阵和矩阵乘法.jpg)
![内嵌习题_矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/23-内嵌习题_矩阵和矩阵乘法.jpg)
![内嵌习题_矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/24-内嵌习题_矩阵和矩阵乘法.jpg)
![内嵌习题_矩阵和矩阵乘法](amWiki/images/001/01-Week1/5-Linear Algebra Review/25-内嵌习题_矩阵和矩阵乘法.jpg)
## English
### Matrix-Matrix Multiplication
![Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/18-举例说明矩阵和矩阵乘法.jpg)
In this video we'll talk about matrix-matrix multiplication, or how to multiply two matrices together. When we talk about the method in linear regression for how to solve for the parameters theta 0 and theta 1 all in one shot, without needing an iterative algorithm like gradient descent. When we talk about that algorithm, it turns out that matrix-matrix multiplication is one of the key steps that you need to know.So let's, as usual, start with an example.Let's say I have two matrices and I want to multiply them together. Let me again just run through this example and then I'll tell you a little bit of what happened. So the first thing I'm gonna do is I'm going to pull out the first column of this matrix on the right. And I'm going to take this matrix on the left and multiply it by a vector that is just this first column.And it turns out, if I do that, I'm going to get the vector 11, 9. So this is the same matrix-vector multiplication as you saw in the last video.I worked this out in advance, so I know it's 11, 9. And then the second thing I want to do is I'm going to pull out the second column of this matrix on the right. And I'm then going to take this matrix on the left, so take that matrix, and multiply it by that second column on the right. So again, this is a matrix-vector multiplication step which you saw from the previous video. And it turns out that if you multiply this matrix and this vector you get 10, 14. And by the way, if you want to practice your matrix-vector multiplication, feel free to pause the video and check this product yourself.Then I'm just gonna take these two results and put them together, and that'll be my answer. So it turns out the outcome of this product is gonna be a two by two matrix. And the way I'm gonna fill in this matrix is just by taking my elements 11, 9, and plugging them here. And taking 10, 14 and plugging them into the second column, okay? So that was the mechanics of how to multiply a matrix by another matrix. You basically look at the second matrix one column at a time and you assemble the answers. And again, we'll step through this much more carefully in a second. But I just want to point out also, this first example is a 2x3 matrix. Multiply that by a 3x2 matrix, and the outcome of this product turns out to be a 2x2 matrix. And again, we'll see in a second why this was the case. All right, that was the mechanics of the calculation. Let's actually look at the details and look at what exactly happened.
### Details of Matrix-Matrix Multiplication
![矩阵和矩阵乘法执行详细过程](amWiki/images/001/01-Week1/5-Linear Algebra Review/19-矩阵和矩阵乘法执行详细过程.jpg)
Here are the details. I have a matrix A and I want to multiply that with a matrix B and the result will be some new matrix C.It turns out you can only multiply together matrices whose dimensions match. So A is an m x n matrix, so m rows, n columns. And we multiply with an n x o matrix. And it turns out this n here must match this n here. So the number of columns in the first matrix must equal to the number of rows in the second matrix. And the result of this product will be a m x o matrix, like the matrix C here. And in the previous video everything we did corresponded to the special case of o being equal to 1. That was to the case of B being a vector. But now we're gonna deal with the case of values of o larger than 1. So here's how you multiply together the two matrices. What I'm going to do is I'm going to take the first column of B and treat that as a vector, and multiply the matrix A by the first column of B. And the result of that will be a n by 1 vector, and I'm gonna put that over here.Then I'm gonna take the second column of B, right? So this is another n by 1 vector. So this column here, this is n by 1. It's an n-dimensional vector. Gonna multiply this matrix with this n by 1 vector. The result will be a m-dimensional vector, which we'll put there, and so on.And then I'm gonna take the third column, multiply it by this matrix. I get a m-dimensional vector. And so on, until you get to the last column. The matrix times the last column gives you the last column of C.Just to say that again, the ith column of the matrix C is obtained by taking the matrix A and multiplying the matrix A with the ith column of the matrix B for the values of i = 1, 2, up through o. So this is just a summary of what we did up there in order to compute the matrix C.
### Example for Matrix-Matrix Multiplication
![Example for Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/20-举例说明矩阵和矩阵乘法.jpg)
Let's look at just one more example. Let's say I want to multiply together these two matrices. So what I'm going to do is first pull out the first column of my second matrix. That was my matrix B on the previous slide and I therefore have this matrix times that vector. And so, oh, let's do this calculation quickly. This is going to be equal to the 1, 3 x 0, 3, so that gives 1 x 0 + 3 x 3. And the second element is going to be 2, 5 x 0, 3, so that's gonna be 2 x 0 + 5 x 3. And that is 9, 15. Oh, actually let me write that in green. So this is 9, 15. And then next I'm going to pull out the second column of this and do the corresponding calculations. So that's this matrix times this vector 1, 2. Let's also do this quickly, so that's 1 x 1 + 3 x 2, so that was that row. And let's do the other one. So let's see, that gives me 2 x 1 + 5 x 2 and so that is going to be equal to, lets see, 1 x 1 + 3 x 1 is 7 and 2 x 1 + 5 x 2 is 12. So now I have these two and so my outcome, the product of these two matrices, is going to be this goes here and this goes here. So I get 9, 15 and 4, 12. [It should be 7,12] And you may notice also that the result of multiplying a 2x2 matrix with another 2x2 matrix, the resulting dimension is going to be that first 2 times that second 2. So the result is itself also a 2x2 matrix.
### Matrix-Matrix Multiplication apply to Hypothesis Function
![Matrix-Matrix Multiplication apply to Hypothesis Function](amWiki/images/001/01-Week1/5-Linear Algebra Review/21-矩阵和矩阵乘法可以用于机器学习中的多个预测函数.jpg)
Finally, let me show you one more neat trick that you can do with matrix-matrix multiplication. Let's say, as before, that we have four houses whose prices we wanna predict.Only now, we have three competing hypotheses shown here on the right. So if you want to apply all three competing hypotheses to all four of your houses, it turns out you can do that very efficiently using a matrix-matrix multiplication. So here on the left is my usual matrix, same as from the last video where these values are my housing prices [he means housing sizes] and I've put 1s here on the left as well. And what I am going to do is construct another matrix where here, the first column is this -40 and 0.25 and the second column is this 200, 0.1 and so on. And it turns out that if you multiply these two matrices, what you find is that this first column, I'll draw that in blue. Well, how do you get this first column?Our procedure for matrix-matrix multiplication is, the way you get this first column is you take this matrix and you multiply it by this first column. And we saw in the previous video that this is exactly the predicted housing prices of the first hypothesis, right, of this first hypothesis here.And how about the second column? Well, [INAUDIBLE] second column. The way you get the second column is, well, you take this matrix and you multiply it by this second column. And so the second column turns out to be the predictions of the second hypothesis up there, and similarly for the third column.And so I didn't step through all the details, but hopefully you can just feel free to pause the video and check the math yourself and check that what I just claimed really is true. But it turns out that by constructing these two matrices, what you can therefore do is very quickly apply all 3 hypotheses to all 4 house sizes to get all 12 predicted prices output by your 3 hypotheses on your 4 houses.So with just one matrix multiplication step you managed to make 12 predictions. And even better, it turns out that in order to do that matrix multiplication, there are lots of good linear algebra libraries in order to do this multiplication step for you. And so pretty much any reasonable programming language that you might be using. Certainly all the top ten most popular programming languages will have great linear algebra libraries. And there'll be good linear algebra libraries that are highly optimized in order to do that matrix-matrix multiplication very efficiently. Including taking advantage of any sort of parallel computation that your computer may be capable of, whether your computer has multiple cores or multiple processors. Or within a processor sometimes there's parallelism as well called SIMD parallelism that your computer can take care of. And there are very good free libraries that you can use to do this matrix-matrix multiplication very efficiently, so that you can very efficiently make lots of predictions with lots of hypotheses.
### Exam_in the video
![Exam_Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/22-内嵌习题_矩阵和矩阵乘法.jpg)
![Exam_Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/23-内嵌习题_矩阵和矩阵乘法.jpg)
![Exam_Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/24-内嵌习题_矩阵和矩阵乘法.jpg)
![Exam_Matrix-Matrix Multiplication](amWiki/images/001/01-Week1/5-Linear Algebra Review/25-内嵌习题_矩阵和矩阵乘法.jpg)
