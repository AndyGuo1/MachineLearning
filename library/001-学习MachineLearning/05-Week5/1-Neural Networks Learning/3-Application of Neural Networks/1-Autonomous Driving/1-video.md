# 神经网络学习- 自动驾驶
## 视频
<video height=510 width=900 controls="controls" preload="none">
      <source src="amWiki/videos/001/05-Week5/1-Neural Networks Learning/8-Autonomous Driving.mp4" type="video/mp4">
</video>
## 中文
### 使用神经网络来实现自动驾驶
![使用神经网络来实现自动驾驶](amWiki/images/001/05-Week5/1-Neural Networks Learning/40-自动驾驶.jpg)
在这段视频中 我想向你介绍一个具有历史意义的 神经网络学习的重要例子 那就是使用神经网络来实现自动驾驶 也就是说使汽车通过学习来自己驾驶 接下来我将演示的 这段视频 是我从 Dean Pomerleau那里拿到的 他是我的同事 任职于美国东海岸的 卡耐基梅隆大学 在这部分视频中 你就会明白可视化技术到底是什么 在看这段视频之前 我会告诉你可视化技术是什么 在下面 也就是左下方 就是汽车所看到的 前方的路况图像 在图中你依稀能看出 一条道路 朝左延伸了一点 又向右了一点 然后上面的这幅图 你可以看到一条 水平的菜单栏 显示的是驾驶操作人 所选择的方向 就是这里的 这条白亮的区段 显示的就是 人类驾驶者选择的方向 比如 最左边的区段 对应的操作就是向左急转 而最右端则对应 向右急转的操作 因此 稍微靠左的区段 也就是这里 中心稍微向左一点的位置 则表示在这一点上 人类驾驶者的操作是 慢慢的向左拐 这幅图的第二部分 对应的就是 学习算法选出的行驶方向 并且 类似的 这一条白亮的区段 显示的就是 神经网络在这里 选择的行驶方向 是稍微的左转 并且实际上 在神经网络开始 学习之前 你会看到网络的输出是 一条灰色的区段 就像这样的一条灰色区段 覆盖着整个区域 这些均称的 灰色区域显示出 神经网络已经随机初始化了 并且初始化时 我们并不知道 汽车如何行驶 或者说 我们并不知道所选行驶方向 只有在学习算法运行了 足够长的时间之后 才会有这条白色的区段 出现在整条灰色区域之中 显示出一个具体的 行驶方向 这就表示神经网络算法 在这时候已经选出了一个 明确的行驶方向 不像刚开始的时候 输出一段模糊的浅灰色区域 而是输出 一条白亮的区段 表示已经选出了明确的行驶方向 ALVINN (Autonomous Land Vehicle In a Neural Network) 是一个基于神经网络的智能系统 通过观察人类的驾驶来学习驾驶 ALVINN能够控制NavLab载具—— 一辆改装版军用悍马 这辆悍马装载了 传感器 计算机和驱动器 用来进行自动驾驶的导航试验 实现ALVINN功能的第一步 是对它进行训练 也就是训练一个人驾驶汽车 然后让ALVINN观看ALVINN每两秒  将前方的路况图生成一张数字化图片 并且记录驾驶者的驾驶方向 得到的训练集图片 被压缩为30x32像素 并且作为输入 提供给ALVINN的三层 神经网络 通过使用反向传播学习算法 ALVINN会训练得到一个 与人类驾驶员操纵方向 基本相近的结果 一开始 我们的网络选择出的方向是随机的 大约经过两分钟的训练后 我们的神经网络 便能够准确地模拟 人类驾驶者的驾驶方向 对其他道路类型 也重复进行这个训练过程 当网络被训练完成后 操作者就可按下运行按钮 车辆便开始行驶 每秒钟ALVINN生成 12次数字化图片 并且将图像传送给神经网络进行训练 多个神经网络同时工作 每一个网络都生成一个行驶方向 以及一个预测自信度的参数 预测自信度最高的 那个神经网络得到的行驶方向 比如这里 在这条单行道上训练出的网络 将被最终用于控制车辆方向 车辆前方突然出现了 一个交叉十字路口 当车辆到达这个十字路口时 我们单行道网络对应的自信度骤减 当它穿过这个十字路口时 前方的双车道将进入其视线 双车道网络的自信度便开始上升 当它的自信度上升时 双车道的网络 将被选择来控制行驶方向 车辆将被安全地引导 进入双车道路 这就是基于神经网络的 自动驾驶技术 当然 我们还有很多 更加先进的试验 来实现自动驾驶技术 在美国 欧洲等一些国家和地区 他们提供了一些比这个方法 更加稳定的驾驶控制技术 但我认为 使用这样一个简单的 基于反向传播的神经网络 训练出如此强大的自动驾驶汽车 的确是一次令人惊讶的成就
## English
### Using a neural network for autonomous driving
![Using a neural network for autonomous driving](amWiki/images/001/05-Week5/1-Neural Networks Learning/40-自动驾驶.jpg)
In this video, I'd like to show you a fun and historically important example of neural networks learning of using a neural network for autonomous driving. That is getting a car to learn to drive itself.The video that I'll showed a minute was something that I'd gotten from Dean Pomerleau, who was a colleague who works out in Carnegie Mellon University out on the east coast of the United States. And in part of the video you see visualizations like this. And I want to tell what a visualization looks like before starting the video.Down here on the lower left is the view seen by the car of what's in front of it. And so here you kinda see a road that's maybe going a bit to the left, and then going a little bit to the right.And up here on top, this first horizontal bar shows the direction selected by the human driver. And this location of this bright white band that shows the steering direction selected by the human driver where you know here far to the left corresponds to steering hard left, here corresponds to steering hard to the right. And so this location which is a little bit to the left, a little bit left of center means that the human driver at this point was steering slightly to the left. And this second bot here corresponds to the steering direction selected by the learning algorithm and again the location of this sort of white band means that the neural network was here selecting a steering direction that's slightly to the left. And in fact before the neural network starts leaning initially, you see that the network outputs a grey band, like a grey, like a uniform grey band throughout this region and sort of a uniform gray fuzz corresponds to the neural network having been randomly initialized. And initially having no idea how to drive the car. Or initially having no idea of what direction to steer in. And is only after it has learned for a while, that will then start to output like a solid white band in just a small part of the region corresponding to choosing a particular steering direction. And that corresponds to when the neural network becomes more confident in selecting a band in one particular location, rather than outputting a sort of light gray fuzz, but instead outputting a white band that's more constantly selecting one's steering direction. >> ALVINN is a system of artificial neural networks that learns to steer by watching a person drive. ALVINN is designed to control the NAVLAB 2, a modified Army Humvee who had put sensors, computers, and actuators for autonomous navigation experiments.The initial step in configuring ALVINN is creating a network just here.During training, a person drives the vehicle while ALVINN watches.Once every two seconds, ALVINN digitizes a video image of the road ahead, and records the person's steering direction.This training image is reduced in resolution to 30 by 32 pixels and provided as input to ALVINN's three layered network. Using the back propagation learning algorithm,ALVINN is training to output the same steering direction as the human driver for that image.Initially the network steering response is random.After about two minutes of training the network learns to accurately imitate the steering reactions of the human driver.This same training procedure is repeated for other road types.After the networks have been trained the operator pushes the run switch and ALVINN begins driving.Twelve times per second, ALVINN digitizes the image and feeds it to its neural networks.Each network, running in parallel, produces a steering direction, and a measure of its' confidence in its' response.The steering direction, from the most confident network, in this network training for the one lane road, is used to control the vehicle.Suddenly an intersection appears ahead of the vehicle.As the vehicle approaches the intersection the confidence of the lone lane network decreases.As it crosses the intersection and the two lane road ahead comes into view, the confidence of the two lane network rises.When its' confidence rises the two lane network is selected to steer. Safely guiding the vehicle into its lane onto the two lane road.So that was autonomous driving using the neural network. Of course there are more recently more modern attempts to do autonomous driving. There are few projects in the US and Europe and so on, that are giving more robust driving controllers than this, but I think it's still pretty remarkable and pretty amazing how instant neural network trained with backpropagation can actually learn to drive a car somewhat well.
